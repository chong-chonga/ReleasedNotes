# JVM



## Java 内存模型

在讲 Java 的方法调用前，先回顾一下 C/C++ 是如何做的。

C/C++ 代码进行方法调用时，会在栈中划出一个栈帧，用于保存返回地址（方法调用的下一条指令的地址）以及方法执行所用到的一些局部变量。**方法调用的参数会优先放在通用寄存器上**，只有当寄存器不能保存全部的参数时，才会将方法参数保存在栈中，供方法使用。

栈帧保存了返回地址、方法参数、局部变量等。

Java 的栈帧和上述类似，只是多了概念：动态链接。



## 垃圾回收



### 引用类型

1. 强引用：Java 中最常用的引用类型；只要对象被强引用所引用，GC永远不会回收该对象。
2. 软引用-SoftReference：常用于实现内存缓存；在 OOM 之前，GC 只是保证会清除所有软引用对象。
3. 弱引用-WeakReference：GC 确定一个对象是弱可达时，就会原子地清除该对象的所有弱引用。
4. 虚引用-PhantomReference：虚引用不决定对象的生命周期。当一个对象要被回收时，该对象的虚引用会被加入到与之相关的队列中，可以通过判断该对象的虚引用是否在队列中来判断该对象是否将被清除。

以上，一般使用软引用来加快垃圾回收速度，其他两种引用很少使用到。





